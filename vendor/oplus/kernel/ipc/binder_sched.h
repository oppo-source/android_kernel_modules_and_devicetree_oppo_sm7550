/* SPDX-License-Identifier: GPL-2.0-only */
/*
 * Copyright (C) 2012 Google, Inc.
 */

#ifndef _OPLUS_BINDER_SCHED_H_
#define _OPLUS_BINDER_SCHED_H_

#include <linux/sched.h>
#include <uapi/linux/android/binder.h>

#define SET_ASYNC_UX_ENABLE				0x45555801
#define ASYNC_UX_ENABLE_DATA_SIZE		4
#define OBS_NOT_ASYNC_UX_VALUE			0xfffffffffffffff1	//(unsigned long - MAX_ERRNO - ...)

#define CURRENT_TASK_PID				-1

enum OBS_STATUS {
	 OBS_INVALID,
	 OBS_VALID,
	 OBS_NOT_ASYNC_UX,
};

#define INVALID_VALUE           -1
#define MAX_UX_IN_LIST			20

enum ASYNC_UX_TEST_ITEM {
	 ASYNC_UX_TEST_DISABLE,
	 ASYNC_UX_RANDOM_LOW_INSERT_TEST,
	 ASYNC_UX_RANDOM_HIGH_INSERT_TEST,
	 ASYNC_UX_RANDOM_LOW_ENQUEUE_TEST,
	 ASYNC_UX_RANDOM_HIGH_ENQUEUE_TEST,
	 ASYNC_UX_INORDER_TEST,
};

enum ASYNC_UX_ENABLE_ITEM {
	ASYNC_UX_DISABLE,
	ASYNC_UX_ENABLE_ENQUEUE,
	ASYNC_UX_ENABLE_INSERT_QUEUE,
	ASYNC_UX_ENABLE_MAX,
};

enum BINDER_THREAD_MODE {
	THREAD_MODE_UNKNOWN,
	THREAD_MODE_SYNC,
	THREAD_MODE_ASYNC,
};

enum {
	LOG_BINDER_SYSTRACE_LVL0	= 1U << 0,
	LOG_BINDER_SYSTRACE_LVL1	= 1U << 1,
	LOG_SET_ASYNC_UX	= 1U << 2,
	LOG_TRACK_ASYNC_UX	= 1U << 3,
	LOG_SET_SYNC_UX		= 1U << 4,
	LOG_GET_LAST_ASYNC	= 1U << 5,
	LOG_TRACK_LAST_ASYNC	= 1U << 6,
	LOG_SET_ASYNC_AFTER_PENDING	= 1U << 7,
	LOG_SET_SF_UX	= 1U << 8,
};

enum {
	STATE_BINDER_UX_NONE = 0,
	STATE_SYNC_UNSET_UX,
	STATE_SYNC_RT_NOT_SET,
	STATE_SYNC_TYPE_UNEXPECTED,
	STATE_SYNC_NOT_SET,
	STATE_ASYNC_UNSET_UX,
	STATE_ASYNC_NOT_SET_LAST_UX,
	STATE_NO_BINDER_THREAD,
	STATE_ASYNC_NO_THREAD_NO_PENDING,
	STATE_SYNC_SET_UX = 20,
	STATE_SYNC_RESET_UX,
	STATE_SYNC_RT_SET_UX,
	STATE_ASYNC_SET_UX,
	STATE_ASYNC_SET_LAST_UX,
	STATE_ASYNC_SET_UX_AFTER_PENDING,
};

struct oplus_binder_struct {
	int async_ux_enable;
	bool pending_async;
};

#endif /* _OPLUS_BINDER_SCHED_H_ */
